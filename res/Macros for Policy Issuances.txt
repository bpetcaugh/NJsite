
Sub OpenModify()

Dim file
Dim path As String
path = "N:\May8\" 
'set path as you see fit here ^ 

file = Dir(path & "*.doc")
Do While file <> ""
Documents.Open filename:=path & file

Call Linker2
ActiveDocument.Save
Call SaveDocumentToPDF
ActiveDocument.Close

file = Dir()
Loop
End Sub


Sub Linker2()

For Each hlink In ActiveDocument.Hyperlinks
'what follows are changes we needed to make to specific hyperlinks based on context. These can be changed to whatever they need to be. 

                If Right(hlink.Address, 6) = ".shtml" And Right(hlink.Address, 15) <> "_issuance.shtml" Then
                                hlink.Address = Replace(hlink.Address, ".shtml", "_issuance.shtml")
                End If
                
                If Left(hlink.Address, 4) = "CP&P" Then
                                hlink.Address = Replace(hlink.Address, "CP&P", "http://manualsdev.dcf.state.nj.us/CPP")
                End If
                
                If Left(hlink.Address, 3) = "C:\" Then
                                hlink.Address = Replace(hlink.Address, "C:\Users\brross\AppData\Local\RJS_Software_Systems\WEBDOCSTEMP\", "")
                End If

Next

End Sub


Sub SaveDocumentToPDF()

  Dim PDFFilePath As String
  Dim PDFFileName As String
  Dim RetVal
 
  With ActiveDocument
    PDFFileName = FileNameNoExt(.Name) & ".pdf"
    PDFFilePath = .path & "\" & PDFFileName
    '.SaveAs FileName:=PDFFilePath, FileFormat:=wdFormatPDF CreateBookmarks:=wdExportCreateHeadingBookmarks
     .ExportAsFixedFormat OutputFileName:=PDFFileName, _
                         ExportFormat:=wdExportFormatPDF, _
                         OpenAfterExport:=True, _
                         OptimizeFor:=wdExportOptimizeForPrint, _
                         Item:=wdExportDocumentContent, _
                         CreateBookmarks:=wdExportCreateHeadingBookmarks
   
    RetVal = Shell("explorer.exe " & .path, vbNormalFocus)

  End With
End Sub